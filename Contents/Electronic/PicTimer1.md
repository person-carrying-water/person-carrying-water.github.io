---
layout: default
title: ":bulb: 電気、PICマイコン"
description: ":memo: PICマイコン／タイマー１について"
date: "2020/05/17"
lastmod: "2020/05/17"
---

## 1. タイマー１の周期計算

`内部クロック周期 = 1 / システムクロック周波数 × 4`  

`TIMER1のカウントアップ周期 = 内部クロック周期 × プリスケーラ設定値`  

_4MHzの場合(PIC内臓)_  
0.000001 = 1 x 4,000,000 x 4  
(1μ秒)  
0.000008 = 0.000001 x 8  
(8μ秒)  

_10MHzの場合_  
0.0000004 = 1 x 10,000,000 x 4  
(0.4μ秒)  
0.0000032 = 0.0000004 \* 8  
(3.2μ秒)  

_20MHzの場合_  
0.0000002 = 1 x 20,000,000 x 4
(0.2μ秒)  
0.0000016 = 0.000000 \* 8  
(1.6μ秒)  

タイマーは、16ビットで扱うためFFFF(65535)とTIMER1のカウントアップ周期を掛けた  
値までが最大インターバルとして計算できる。  

4MHzの例) 0.000008 x 65535 = 0.52428秒  

タイマー１は、FFFFを超えて0に戻る時にフラグがアップする  
よって、0.1秒タイマーを測りたい時は4MHzの0→FFFF(0.52428)を0からスタート  
ではなく0.42428からスタートすれば良い。

12500(カウント値) x 0.000008 = 0.1秒  
65535 - 12500 = 53035  
53035を16進数に変換=CF2B

CF2B→FFFFまでが0.1秒となる(4MHzの場合)  
毎回CF2Bをセットし、FFFFまでをカウントすれば0.1秒タイマーを発生させる事ができる。  

* * *
