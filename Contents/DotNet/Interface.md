---
layout: default
title: ":eyeglasses: .NET(C#、VB.NET、C++/CLI、F#)"
description: ":black_nib: .NETにおけるインタフェース、抽象クラスの違いとそのメリット"
date: "2020/05/17"
lastmod: "2020/05/17"
---

## 0.はじめに

インターフェースや抽象クラスは将来を考慮しての保守、メンテナンス、拡張に柔軟に対応できるメリットがあると言う。  
インタフェースと抽象クラスのメリットは、その系統や種類の用途(メソッドなど)だけを定義して置きそれを実装する側が  
自由に書くことが出来る事とその用途(メソッド)は必ず実装しなければならない決まり事を作る事ができる。  
これを実装しないとエラーが起こさせる事ができるので数人の開発や忘れ防止になると言う。    

また、親クラスへのキャストの機能を使い引数やメソッドは親クラスで受け渡しを行うことによりプログラムを変更しない  
書き方にも対応出来る。  

<br />

## 1. .NETにおける抽象クラスとインターフェースクラスの違い

### 抽象クラス

**出来る事**  
1. メソッドの定義だけでなく実装(中身)を書くことができる  
2. フィールド変数を持てる  
3. 定数やプロパティの中身を書くことができる  

**出来ない事**  
1. 通常のクラス同様、多重継承できない  

### インタフェース

※インターフェースと分かる様にの命名規則で先頭は`I`の文字を付ける事が推奨されている  

**出来る事**  
1. 多重継承できる  
2. 定数(VB.NETは不可)、Public ReadOnlyのフィールドを持つ事ができる  

**出来ない事**  
1. メソッドの実装(中身)を書くことができない  
2. フィールド変数を持つ事ができない  
3. プロパティのget、setは持てるがその中身を書くことができない  

<br />

## 2. インターフェースのメリット

インターフェースを使わない例と使った例でどの様な事が起きるのかの例。※電池の誕生年数は適当です。  
また、その電池でその電気製品を使うのかという事も若干適当です。  

### 通常のクラスのみで使う例

例えば、1980年に電池という物が存在しそれは乾電池とボタン電池のみでした。ボタン電池はたちまち使わないので  
乾電池のみで扇風機を回すことにしました。この乾電池は`使う`と`充電`という用途を持ちます。  
`使う`方法としては`回す事`です。`充電`方法は、家庭用のコンセントから充電します。  
そして、乾電池のクラスを作ってみます。  

```csharp
public class kandenchi
{
  public void tukau() {
    //扇風機を回す作業をします。
  }
  public void jyuden() {
    //家庭用のコンセントから充電する作業をします。
  }
}
```

kandenchiクラスを使う側のクラスを作成し使えるようになりました。  
別段、これでも問題ありません。  

```csharp
public class main
{
  private void method(kandenchi kden) {
      kden.tukau();
  }
}
```

さて、時代は流れ2015年、太陽光で充電する蓄電池が出回るようになりこれは高速で回せるのでこれを使う事になりました。  
充電も太陽光で充電しなくてはならなくなりました。そこで以下の様な太陽光蓄電池クラスを別途作りました。

```csharp
public class taiyodenchi
{
  public void kousoku() {
    //扇風機を高速に回す作業をします。
  }
  public void jyuden() {
    //太陽光から充電する作業をします。
  }
}
```

ここでmainクラスは引数の型とオブジェクト名とメソッド名を変えなくてはなりませんでした。これは、保守性やメンテナンス性、  
拡張性を考慮していないためこの様な事態となりました。  
または、メソッド名については、kandenchiクラスを作った人とtaiyodenchを作った人が別だった。  
さらには、kandenchiクラスを作った人と同じであるがかなり前の事なので忘れて新たなメソッド名を付けてしまった事も考えられる。  

```csharp
public class main
{
  private void method(taiyodenchi tden) { //kandenchiからtaiyodenchiに変更
      tden.kousoku();
  }
}
```

### インタフェースを使った方法

次は、インターフェースを使った方法です。  
将来の活用方法も考慮し電池インタフェースを用意し`使う`メソッドと`充電`メソッドという抽象的な事のみ定義してみます。  
インターフェースはアクセス修飾子を付けず実装側はpublicでなければならない。(VB.NETは可)  

```csharp
interface denchi
{
  void tukau();
  void jyuden();
}
```

次にdenchiインタフェースを継承し乾電池のクラスを作ります。  

    public class kandenchi : denchi
    {
      public void tukau() {
        //扇風機を回す作業をします。
      }
      public void jyuden() {
        //家庭用のコンセントから充電する作業をします。
      }
    }

次にdenchiインタフェースを継承し太陽光蓄電池クラスも作ります。  
denchiインタフェースを継承しているのでtukau()とjyuden()メソッドを使わなければならなくなりました。  

    public class taiyodenchi : denchi
    {
      public void tukau() {
        //扇風機を高速に回す作業をします。
      }
      public void jyuden() {
        //太陽光から充電する作業をします。。
      }
    }

呼び出し側は、親キャストの機能を使い親クラスであるdenchiインタフェース引数で使う様にして置く。  
これで、乾電池クラスのオブジェクトで引数へ渡すことにより通常の使い方が出来ますし太陽電池クラスのオブジェクトで  
引数へ渡すことにより高速に回す使い方もできるmethod()というメソッドが出来上がりました。  

```csharp
public class main
{
  private void method(denchi den) {
      denchi.tukau();
  }
}
```

<br />

さらに、やはりボタン電池も使う事になりましたのでボタン電池クラスを作ります。  
メンテナンス、拡張性が上がった様な気がします。  

    public class botandenchi : denchi
    {
      public void tukau() {
        //扇風機を低速に回す作業をします。
      }
      public void jyuden() {
        //家庭用のコンセントから充電する作業をします。
      }
    }

* * *
