---
layout: default
title: ":octocat: セキュリティ"
description: ":closed_lock_with_key: SSL(Secure Sockets Layer)の証明書について"
date: "2020/05/17"
lastmod: "2020/05/17"
---

## 0. SSL(Secure Sockets Layer)について

暗号化をして通信を行う事ができそのためには公開鍵サーバー証明書(デジタル証明書)が必要です。  
SSLについて検索すると色々な用語や同じ意味を持つ言葉があり分かりにくかったので自分でまとめてみました。  
まだ間違いがあるかもしれないのでその都度修正していく事にします。  

<br />

## 1. 認証局(CA:Certification Authority)

デジタル証明書(公開鍵証明書)を発行する機関であり、電子証明書の登録、発行、失効を行う第三者機関や管理者の事です。  
認証局は秘密鍵を持っておりその秘密鍵でデジタル署名をします。そのデジタル署名されたものを公開鍵証明書といいます。  
認証局は、ルート認証局、中間認証局、オレオレ認証局があります。  

### 1-1. ルート認証局(RCA:Root Certification Authority)

ルート認証局とは、他の認証局へ証明書を発行をする最上位の認証局の事です。  

#### 第三者機関ルート認証局(パブリック認証局)

第三者機関のルート認証局は、厳しい監査に通過した機関のみが認められており自身で正当性を証明して他の認証局へ証明書を  
発行する最上位の信頼された認証局です。    

#### オレオレ認証局(プライベート認証局){自己署名認証局}

その他、審査を受けていない一般人が自身で証明書の発行を行う事もできます。  
認証局でも何でもありませんがその一般人(管理者)が構築したものをオレオレ認証局(プライベート認証局)と呼ばれています。  
上位に認証局が無いためこれもルート認証局となります。  
その証明書の事をオレオレ証明書(プライベート証明書)といいます。※詳しくはオレオレ証明書参照。  

### 1-2. 中間認証局(ICA:Intermediate Certification Authority)

中間認証局は、上位の認証局から信頼を受けて自身の正当性を証明する認証局です。  
中間認証局も上位の認証局が発行したデジタル証明書を持っておりその証明書で上位認証局に検証を行わなければならない。  
しかし、いくつもの認証局が間にあると認証が中々終わりません。そこでブラウザなどには厳しい監査で信用された最上位に当たる  
ような認証局の証明書(WebTrustルート証明書)をいくつか内蔵しておりいずれかの証明書と検証が取れれば認証成立となる。  

<br />

## 2. 証明書(Certificate)

暗号化通信で自身のサーバーや認証局を証明するために使われるデジタル証明書。  

### 2-1. 公開鍵証明書(PKC:Public Key Certificate){デジタル証明書}

認証局が対象のサーバーから発行されたものである事を認めた証明書の事です。  
認証局が申請者の公開鍵をもとに情報を付加した証明書署名要求に秘密鍵でデジタル署名をしたものです。  
デジタル署名に必要なものは秘密鍵のみで行われその証明書には公開鍵が含まれる事が一般的です。  
公開鍵を改ざんされた場合は正常な暗号化通信が成り立たなくなる。これを避けるために第三者機関がその証明書署名要求  
にデジタル署名を施して正しいものであると保証する。  
公開鍵証明書には、サーバー証明書、クライアント証明書、ルート証明書、オレオレ証明書などがあります。  
公開鍵証明書は、デジタル証明書、SSL証明書、証明書と呼ばれる事もあります。  

**デジタル署名**  
信頼を有する者が、自身の秘密鍵で信頼のない者の公開鍵のハッシュ値を暗号化した結果ものをデジタル署名と言います。  

**公開鍵基盤(PKI:Public Key Infrastructure)**  
公開鍵とその公開鍵の持ち主の保証を行うために必要となる仕組みの事です。  

**証明書署名要求(CSR:Certificate Signing Request)**  
公開鍵証明書の発行を認証局に要求するメッセージです。申請者の公開鍵と識別情報などが記載されており申請者の秘密鍵で  
デジタル署名したものを認証局へ送る。なので、事前に秘密鍵と公開鍵のペアを生成しておく必要がある。  

**証明書失効リスト(CRL:Certificate Revocation List)**  
秘密鍵の紛失や漏洩などにより信頼できなくなった公開鍵証明書や有効期限が切れた公開鍵証明書のシリアル番号のリストである。   

**X.509(エックス ポイント ゴーマルキュー)**  
公開鍵基盤の標準規格の事です。  

#### 2-1-1. サーバー証明書

認証局から発行された公開鍵証明書である。  
クライアント側はその証明書が信頼性のあるものかチェックする事ができます。  
サーバ証明書の中には、第三者機関の認証局ではない一般人管理者がルート認証局の様な作業を行いサーバ証明書を発行した場合  
ブラウザでは警告が出ます。  

#### 2-1-2. クライアント証明書

その名の通りクライアントを証明する証明書である。  
サーバー証明書の場合は不特定多数のクライアントからアクセスする事ができてしまいます。  
そこで、クライアント証明書を持つクライアントのみアクセスを行いたい場合の認証用にこの証明書が使われます。  

#### 2-1-3. ルート証明書(RC:Root certificate)

発行者と申請者(主体者)が同じで、さらに自分自身の秘密鍵でそれに対応した自らの公開鍵に署名し発行した公開鍵証明書  
の事です。  
サーバー証明書が本当にその認証局のものかを検証するために使われます。  
主な認証局のルート証明書はＯＳやブラウザに導入されておりアクセスする際には自動的に検証されています。  

#### 第三者機関ルート証明書(パブリック証明書)

厳しい監査で通過した第三者機関(公的)によって発行された公開鍵証明書の事です。  
第三者機関のルート証明書の中で、WebTrustルート証明書はWebTrustの厳格な審査基準を満たし監査にパスした世界で数社しか  
無い信頼の頂点にあるルート証明書です。  
この第三者機関ルート証明書は、世界に認められた認証局としてブラウザ等に標準で搭載される事が許されています。  

#### オレオレ証明書(プライベート証明書){自己署名証明書}

第三者機関ではなく審査を受けていない一般人が自身で適当な秘密鍵から公開鍵証明書を作成する事ができます。  
自身を認証局(自己認証局)として公開鍵証明書の作成を行ったものであるのでオレオレ証明書といいます。  
信頼性は無いですが、自己認証局なので事実上ルート認証局でもありルート証明書でもある。  
それでも通信の暗号化はできるので開発やデバッグ、社内のイントラネットでの活用に取り敢えず使われている。  
中には取り敢えず暗号化だけ出来れば良いとオレオレ証明書で行われているものも存在する。  

* * *
